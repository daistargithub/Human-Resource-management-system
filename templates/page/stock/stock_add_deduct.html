<md-card class="md-whiteframe-1dp md-padding">
  <!-- Search -->
  <form role="form" name="frm_search">
    <div layout="row">
      <md-input-container flex="30">
        <label>Enter Here To Search</label>
        <input name="ingredient_func" ng-model="search.ingredient_func" />
        <div ng-messages="frm_search.ingredient_func.$error">
          <!-- <div ng-message='required'>required.</div> -->
          <div ng-message='minlength'>min length 5.</div>
        </div>
      </md-input-container>
      <md-input-container flex="5">
      </md-input-container>
      <md-input-container flex="15">
        <label>Select Type</label>
        <md-select name="type" ng-model="search.type">
          <md-option ng-value="t.type_name" ng-repeat="t in types">{{t.type_name}}</md-option>
        </md-select>
        <div ng-messages="frm_search.type.$error">
          <!-- <div ng-message="required">required.</div> -->
        </div>
      </md-input-container>
      <md-input-container flex="5">
      </md-input-container>
      <md-input-container flex="10">
        <label> Start Date</label>
        <!--<input name="start_date" pattern="(?:19|20)[0-9]{2}-(?:(?:0[1-9]|1[0-2])-(?:0[1-9]|1[0-9]|2[0-9])|(?:(?!02)(?:0[1-9]|1[0-2])-(?:30))|(?:(?:0[13578]|1[02])-31))" ng-model="dates.start_date" required  onkeydown="return !(event.keyCode==13)"/>-->
        <input name="start_date" ng-model="search.start_date" maxlength="10" datetime-picker date-format="dd-MM-yyyy"
          autocomplete="off" date-only onkeydown="return !(event.keyCode==13)" />
        <div ng-messages="frm_search.start_date.$error">
          <!-- <div ng-message='required'>required.</div> -->
          <div ng-message='pattern'>Enter a Valid Date. (dd-mm-yyyy format)</div>
          <div ng-message='maxlength'>Only dd-mm-yyyy format.</div>
        </div>
      </md-input-container>
      <md-input-container flex="5">
      </md-input-container>
      <md-input-container flex="10">
        <label> End Date</label>
        <!--<input name="end_date" pattern="(?:19|20)[0-9]{2}-(?:(?:0[1-9]|1[0-2])-(?:0[1-9]|1[0-9]|2[0-9])|(?:(?!02)(?:0[1-9]|1[0-2])-(?:30))|(?:(?:0[13578]|1[02])-31))" ng-model="dates.end_date" required  onkeydown="return !(event.keyCode==13)"/>-->
        <input name="end_date" ng-model="search.end_date" maxlength="10" datetime-picker date-format="dd-MM-yyyy"
          autocomplete="off" date-only onkeydown="return !(event.keyCode==13)" />
        <div ng-messages="frm_search.end_date.$error">
          <!-- <div ng-message='required'>required.</div> -->
          <div ng-message='pattern'>Enter a Valid Date. (dd-mm-yyyy format)</div>
          <div ng-message='maxlength'>Only dd-mm-yyyy format.</div>
        </div>
      </md-input-container>
      <md-input-container flex="5">
      </md-input-container>
      <md-input-container flex="15">
        <md-button ng-disabled="frm_search.$invalid" ng-click="getSearchResult(search)" class="md-raised md-accent">
          Search
        </md-button>
      </md-input-container>
    </div>
  </form>
  <br><br>
  <!-- Addition or Subtraction -->
  <form role="form" name="frm_add_subtract">
    <div layout="row">
      <md-input-container flex="15">
        <label>Enter Function Name</label>
        <input name="function" ng-model="build.function" required />
        <div ng-messages="frm_add_subtract.function.$error">
          <div ng-message='required'>required.</div>
          <div ng-message='minlength'>min length 5.</div>
        </div>
      </md-input-container>
      <md-input-container flex="5">
      </md-input-container>
      <md-input-container flex="15">
        <label>Select Ingredient</label>
        <md-select required name="ingredient" ng-model="build.ingredient" required>
          <md-option ng-repeat="i in ingredients" ng-value="i.id">{{i.title}}{{"-"}}{{i.unit}}</md-option>
        </md-select>
        <div ng-messages="frm_add_subtract.ingredient.$error">
          <div ng-message="required">required.</div>
        </div>
      </md-input-container>
      <md-input-container flex="5">
      </md-input-container>
      <md-input-container flex="10">
        <label>Quantity</label>
        <input name="quantity" type="number" min="1" ng-model="build.quantity" required />
        <div ng-messages="frm_add_subtract.quantity.$error">
          <div ng-message='required'>required.</div>
          <div ng-message='type'>number only</div>
        </div>
      </md-input-container>
      <md-input-container flex="5">
      </md-input-container>
      <md-input-container flex="10">
        <label>Remarks</label>
        <input name="remarks" ng-model="build.remarks" />
        <div ng-messages="frm_add_subtract.remarks.$error">
          <div ng-message='required'>required.</div>
          <div ng-message='minlength'>min length 5.</div>
        </div>
      </md-input-container>
      <md-input-container flex="5">
      </md-input-container>
      <md-input-container flex="10">
        <label>Select Date</label>
        <!--<input name="start_date" pattern="(?:19|20)[0-9]{2}-(?:(?:0[1-9]|1[0-2])-(?:0[1-9]|1[0-9]|2[0-9])|(?:(?!02)(?:0[1-9]|1[0-2])-(?:30))|(?:(?:0[13578]|1[02])-31))" ng-model="dates.start_date" required  onkeydown="return !(event.keyCode==13)"/>-->
        <input name="date" ng-model="build.date" maxlength="10" datetime-picker date-format="dd-MM-yyyy" date-only
          required autocomplete="off" onkeydown="return !(event.keyCode==13)" />
        <div ng-messages="frm_add_subtract.date.$error">
          <div ng-message='required'>required.</div>
          <div ng-message='pattern'>Enter a Valid Date. (dd-mm-yyyy format)</div>
          <div ng-message='maxlength'>Only dd-mm-yyyy format.</div>
        </div>
      </md-input-container>

      <md-input-container flex="10">
        <md-button ng-disabled="frm_add_subtract.$invalid" ng-click="Subtraction(build)" class="md-raised md-accent">
          Subtraction
        </md-button>
      </md-input-container>
      <md-input-container flex="10">
        <md-button ng-disabled="frm_add_subtract.$invalid" ng-click="Addition(build)" class="md-raised md-accent">
          Addition
        </md-button>
      </md-input-container>
    </div>
  </form>
</md-card>
<md-card class="md-whiteframe-1dp md-padding">
  <div class="table-responsive-vertical">
    <h4> Latest Addition/Subtraction </h4>
    <md-button ng-disabled="currentPage == 0" ng-click="currentPage=currentPage-1">
      <md-icon>fast_rewind</md-icon>
    </md-button>
    {{currentPage+1}}/{{numberOfPages()}}
    <md-button ng-disabled="currentPage >= stock_histories.length/pageSize - 1" ng-click="currentPage=currentPage+1">
      <md-icon>fast_forward</md-icon>
    </md-button>
    <table id="day_table" class="table table-hover" ng-table="table_theday">
      <thead>
        <tr>
          <th width="5%">No</th>
          <th ng-click="sort('title')" width="10%">Ingredient</th>
          <th ng-click="sort('function')" width="15%">Function Name</th>
          <th ng-click="sort('quentity')" width="5%">Quantity</th>
          <th ng-click="sort('type')" width="10%">Type</th>
          <th ng-click="sort('remarks')" width="10%">Remark</th>
          <th ng-click="sort('datetime')" width="10%">Date</th>
        </tr>
      </thead>
      <tbody>
        <tr ng-repeat="s in stock_histories | orderBy:sortKey:reverse | filter:search.ingredient_func | startFrom:currentPage*pageSize | limitTo:pageSize">
          <td data-title="Id">{{currentPage*pageSize+$index+1}}</td>
          <td data-title="Ingredient">{{s.title}} - ({{s.unit}}) </td>
          <td data-title="Function Name">{{s.function}}</td>
          <td data-title="Quantity">{{s.quantity}}</td>
          <td data-title="Type">{{s.type}}</td>
          <td data-title="Remark">{{s.remarks}}</td>
          <td data-title="Date" maxlength="10">{{s.datetime | mysqlToJS:s.datetime | date:'dd-MM-yyyy HH:mm:ss'}}</td>
        </tr>
        <tr ng-if="loading">
          <td style="text-align:center;" colspan="10">Loading...</td>
        </tr>
      </tbody>
    </table>
    <md-button ng-disabled="currentPage == 0" ng-click="currentPage=currentPage-1">
      <md-icon>fast_rewind</md-icon>
    </md-button>
    {{currentPage+1}}/{{numberOfPages()}}
    <md-button ng-disabled="currentPage >= stock_histories.length/pageSize - 1" ng-click="currentPage=currentPage+1">
      <md-icon>fast_forward</md-icon>
    </md-button>
  </div>
</md-card>